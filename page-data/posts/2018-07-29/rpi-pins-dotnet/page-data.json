{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/posts/2018-07-29/rpi-pins-dotnet/","webpackCompilationHash":"15714a159ebeeea48a90","result":{"data":{"markdownRemark":{"html":"<p>Python seems to be the language of choice for working with Raspberry Pi’s GPIO pins.  But, some of the other language like typescript/javascript and dotnet core have libraries for getting and setting pin values also. It seems that under the covers, its just looking at a directory structure and some files and values in those directories.</p>\n<p>For my dotnet core project, I picked up a nuget package called <a href=\"https://github.com/jeremylindsayni/Bifrost\">bifrost</a> that gives me what I needed. To use this library, I made a simple “service” or “provider” that interacts with these pins:</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-csharp line-numbers\"><code class=\"language-csharp\"><span class=\"token keyword\">namespace</span> rpi_garage_door<span class=\"token punctuation\">.</span>Services \n<span class=\"token punctuation\">{</span> \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PinService</span><span class=\"token punctuation\">:</span><span class=\"token class-name\">IPinService</span> \n    <span class=\"token punctuation\">{</span> \n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> <span class=\"token class-name\">IGpioController</span> _gpioController<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> ILogger<span class=\"token operator\">&lt;</span>PinService<span class=\"token operator\">></span> _logger<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">PinService</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IGpioController</span> gpioController<span class=\"token punctuation\">,</span> ILogger<span class=\"token operator\">&lt;</span>PinService<span class=\"token operator\">></span> logger<span class=\"token punctuation\">)</span> \n        <span class=\"token punctuation\">{</span> \n            _logger <span class=\"token operator\">=</span> logger<span class=\"token punctuation\">;</span>\n            _gpioController <span class=\"token operator\">=</span> gpioController<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> \n        \n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">CheckPin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> pinId<span class=\"token punctuation\">)</span> \n        <span class=\"token punctuation\">{</span> \n            <span class=\"token class-name\">GpioPinValue</span> pinStatus<span class=\"token punctuation\">;</span>\n            _logger<span class=\"token punctuation\">.</span><span class=\"token function\">LogInformation</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"About to get pin status:\"</span> <span class=\"token operator\">+</span> pinId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">var</span> pin <span class=\"token operator\">=</span> _gpioController<span class=\"token punctuation\">.</span><span class=\"token function\">OpenPin</span><span class=\"token punctuation\">(</span>pinId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pinStatus <span class=\"token operator\">=</span> pin<span class=\"token punctuation\">.</span><span class=\"token function\">Read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            _logger<span class=\"token punctuation\">.</span><span class=\"token function\">LogInformation</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Returning pin status.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            _logger<span class=\"token punctuation\">.</span><span class=\"token function\">LogInformation</span><span class=\"token punctuation\">(</span>pinStatus<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>pinStatus<span class=\"token punctuation\">;</span> \n        <span class=\"token punctuation\">}</span> \n            \n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">bool</span> <span class=\"token function\">WritePin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> pinId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">GpioPinValue</span> pinValue<span class=\"token punctuation\">)</span> \n        <span class=\"token punctuation\">{</span> \n            <span class=\"token keyword\">var</span> pin <span class=\"token operator\">=</span> _gpioController<span class=\"token punctuation\">.</span><span class=\"token function\">OpenPin</span><span class=\"token punctuation\">(</span>pinId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pin<span class=\"token punctuation\">.</span><span class=\"token function\">SetDriveMode</span><span class=\"token punctuation\">(</span>GpioPinDriveMode<span class=\"token punctuation\">.</span>Output<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            _logger<span class=\"token punctuation\">.</span><span class=\"token function\">LogInformation</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Writing Pin: \"</span> <span class=\"token operator\">+</span> pinValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pin<span class=\"token punctuation\">.</span><span class=\"token function\">Write</span><span class=\"token punctuation\">(</span>pinValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> \n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>So for checking the value, it would return a 0 value for when the pin is in an LOW state and 1 when its in a HIGH state. In relation to my sensor, when the pin is 0, the door is open and the contact sensor is not making contact. Flip that, when the value is 1, the door is closed and the contact sensor is making contact.</p>\n<p>Additionally, there is a function to write a value to the pin. For this project, the code would write the value to the pin to “activate” the garage door opener. When a call is made to change the garage door state, I have another service that writes the pin value to HIGH and then writes it back to LOW after 1 second.</p>\n<p><a href=\"https://github.com/cacodev/rpi-garage-door\">For more on this, take a look at the code on GitHub</a></p>","frontmatter":{"title":"Getting and Setting pins for RPI using dotnet core and BIFROST","cover":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/2018-07-29/rpi-pins-dotnet/","coverImageMaxWidth":800}}}